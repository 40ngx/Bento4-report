{
  "Date": "2024-04-07T07:37:25.962858+00:00",
  "Uname": "Linux 9ef9146dd797 5.15.0-56-generic #62-Ubuntu SMP Tue Nov 22 19:54:14 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux",
  "OS": "Ubuntu",
  "OSRelease": "22.04",
  "Architecture": "amd64",
  "ExecutablePath": "../mp4audioclip",
  "ProcEnviron": [
    "PWD=/root/fuzzing_Bento4/Bento4/cmakebuild/fuzz",
    "HOME=/root",
    "TERM=xterm",
    "SHLVL=1",
    "PATH=/root/.cargo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
    "_=/usr/local/bin/casr-afl",
    "OLDPWD=/root/fuzzing_Bento4/Bento4/cmakebuild",
    "ASAN_OPTIONS=hard_rss_limit_mb=2048"
  ],
  "ProcCmdline": "../mp4audioclip out6/Main/crashes/id:000000,sig:06,src:000838,time:1358665,execs:365015,op:havoc,rep:6 mp4audioclip_out/out",
  "Stdin": "",
  "ProcStatus": [],
  "ProcMaps": [],
  "ProcFiles": [],
  "NetworkConnections": [],
  "CrashSeverity": {
    "Type": "EXPLOITABLE",
    "ShortDescription": "heap-buffer-overflow(write)",
    "Description": "Heap buffer overflow",
    "Explanation": "The target writes data past the end, or before the beginning, of the intended heap buffer."
  },
  "Stacktrace": [
    "    #0 0x5555556a7ea9 in __asan_memcpy (/root/fuzzing_Bento4/Bento4/cmakebuild/mp4audioclip+0x153ea9) (BuildId: 3d5dee7420df78bb)",
    "    #1 0x55555570d4e0 in AP4_MemoryByteStream::WritePartial(void const*, unsigned int, unsigned int&) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4ByteStream.cpp:785:5",
    "    #2 0x55555570fded in AP4_ByteStream::Write(void const*, unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4ByteStream.cpp:77:29",
    "    #3 0x555555805d53 in AP4_CencSampleEncryption::DoWriteFields(AP4_ByteStream&) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4CommonEncryption.cpp:3569:16",
    "    #4 0x55555570654c in AP4_Atom::Clone() /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Atom.cpp:316:9",
    "    #5 0x555555741fb3 in AP4_ContainerAtom::Clone() /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4ContainerAtom.cpp:172:56",
    "    #6 0x55555583aeed in AP4_ProtectionSchemeInfo::AP4_ProtectionSchemeInfo(AP4_ContainerAtom*) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Protection.cpp:319:60",
    "    #7 0x55555583aeed in AP4_ProtectedSampleDescription::AP4_ProtectedSampleDescription(unsigned int, AP4_SampleDescription*, unsigned int, unsigned int, unsigned int, char const*, AP4_ContainerAtom*, bool) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Protection.cpp:689:24",
    "    #8 0x55555583b7db in AP4_EncaSampleEntry::ToSampleDescription() /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Protection.cpp:96:20",
    "    #9 0x5555558b2af8 in AP4_StsdAtom::GetSampleDescription(unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4StsdAtom.cpp:181:53",
    "    #10 0x5555556ea420 in AP4_Track::GetSampleDescription(unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Track.cpp:447:43",
    "    #11 0x5555556ea420 in main /root/fuzzing_Bento4/Bento4/Source/C++/Apps/Mp4AudioClip/Mp4AudioClip.cpp:143:66",
    "    #12 0x7ffff7a7dd8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16",
    "    #13 0x7ffff7a7de3f in __libc_start_main csu/../csu/libc-start.c:392:3",
    "    #14 0x555555625c84 in _start (/root/fuzzing_Bento4/Bento4/cmakebuild/mp4audioclip+0xd1c84) (BuildId: 3d5dee7420df78bb)"
  ],
  "Registers": {},
  "Disassembly": [],
  "Package": "",
  "PackageVersion": "",
  "PackageArchitecture": "",
  "PackageDescription": "",
  "AsanReport": [
    "==1018801==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61900000099c at pc 0x5555556a7eaa bp 0x7fffffffde00 sp 0x7fffffffd5d0",
    "WRITE of size 4294967294 at 0x61900000099c thread T0",
    "    #0 0x5555556a7ea9 in __asan_memcpy (/root/fuzzing_Bento4/Bento4/cmakebuild/mp4audioclip+0x153ea9) (BuildId: 3d5dee7420df78bb)",
    "    #1 0x55555570d4e0 in AP4_MemoryByteStream::WritePartial(void const*, unsigned int, unsigned int&) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4ByteStream.cpp:785:5",
    "    #2 0x55555570fded in AP4_ByteStream::Write(void const*, unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4ByteStream.cpp:77:29",
    "    #3 0x555555805d53 in AP4_CencSampleEncryption::DoWriteFields(AP4_ByteStream&) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4CommonEncryption.cpp:3569:16",
    "    #4 0x55555570654c in AP4_Atom::Clone() /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Atom.cpp:316:9",
    "    #5 0x555555741fb3 in AP4_ContainerAtom::Clone() /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4ContainerAtom.cpp:172:56",
    "    #6 0x55555583aeed in AP4_ProtectionSchemeInfo::AP4_ProtectionSchemeInfo(AP4_ContainerAtom*) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Protection.cpp:319:60",
    "    #7 0x55555583aeed in AP4_ProtectedSampleDescription::AP4_ProtectedSampleDescription(unsigned int, AP4_SampleDescription*, unsigned int, unsigned int, unsigned int, char const*, AP4_ContainerAtom*, bool) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Protection.cpp:689:24",
    "    #8 0x55555583b7db in AP4_EncaSampleEntry::ToSampleDescription() /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Protection.cpp:96:20",
    "    #9 0x5555558b2af8 in AP4_StsdAtom::GetSampleDescription(unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4StsdAtom.cpp:181:53",
    "    #10 0x5555556ea420 in AP4_Track::GetSampleDescription(unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Track.cpp:447:43",
    "    #11 0x5555556ea420 in main /root/fuzzing_Bento4/Bento4/Source/C++/Apps/Mp4AudioClip/Mp4AudioClip.cpp:143:66",
    "    #12 0x7ffff7a7dd8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16",
    "    #13 0x7ffff7a7de3f in __libc_start_main csu/../csu/libc-start.c:392:3",
    "    #14 0x555555625c84 in _start (/root/fuzzing_Bento4/Bento4/cmakebuild/mp4audioclip+0xd1c84) (BuildId: 3d5dee7420df78bb)",
    "",
    "0x61900000099c is located 0 bytes to the right of 1052-byte region [0x619000000580,0x61900000099c)",
    "allocated by thread T0 here:",
    "    #0 0x5555556e3a2d in operator new[](unsigned long) (/root/fuzzing_Bento4/Bento4/cmakebuild/mp4audioclip+0x18fa2d) (BuildId: 3d5dee7420df78bb)",
    "    #1 0x5555557161a7 in AP4_DataBuffer::ReallocateBuffer(unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4DataBuffer.cpp:210:28",
    "    #2 0x5555557161a7 in AP4_DataBuffer::SetBufferSize(unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4DataBuffer.cpp:136:16",
    "    #3 0x5555557161a7 in AP4_DataBuffer::Reserve(unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4DataBuffer.cpp:107:12",
    "",
    "SUMMARY: AddressSanitizer: heap-buffer-overflow (/root/fuzzing_Bento4/Bento4/cmakebuild/mp4audioclip+0x153ea9) (BuildId: 3d5dee7420df78bb) in __asan_memcpy",
    "Shadow bytes around the buggy address:",
    "  0x0c327fff80e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00",
    "  0x0c327fff80f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00",
    "  0x0c327fff8100: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00",
    "  0x0c327fff8110: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00",
    "  0x0c327fff8120: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00",
    "=>0x0c327fff8130: 00 00 00[04]fa fa fa fa fa fa fa fa fa fa fa fa",
    "  0x0c327fff8140: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa",
    "  0x0c327fff8150: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa",
    "  0x0c327fff8160: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa",
    "  0x0c327fff8170: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa",
    "  0x0c327fff8180: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa",
    "Shadow byte legend (one shadow byte represents 8 application bytes):",
    "  Addressable:           00",
    "  Partially addressable: 01 02 03 04 05 06 07",
    "  Heap left redzone:       fa",
    "  Freed heap region:       fd",
    "  Stack left redzone:      f1",
    "  Stack mid redzone:       f2",
    "  Stack right redzone:     f3",
    "  Stack after return:      f5",
    "  Stack use after scope:   f8",
    "  Global redzone:          f9",
    "  Global init order:       f6",
    "  Poisoned by user:        f7",
    "  Container overflow:      fc",
    "  Array cookie:            ac",
    "  Intra object redzone:    bb",
    "  ASan internal:           fe",
    "  Left alloca redzone:     ca",
    "  Right alloca redzone:    cb",
    "==1018801==ABORTING"
  ],
  "UbsanReport": [],
  "PythonReport": [],
  "GoReport": [],
  "JavaReport": [],
  "RustReport": [],
  "JsReport": [],
  "CSharpReport": [],
  "CrashLine": "/root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4ByteStream.cpp:785:5",
  "Source": [
    "    781            return AP4_ERROR_EOS;",
    "    782        }",
    "    783    ",
    "    784        // write to memory",
    "--->785        AP4_CopyMemory((void*)(m_Buffer->UseData()+m_Position), buffer, bytes_to_write);",
    "    786        m_Position += bytes_to_write;",
    "    787    ",
    "    788        bytes_written = bytes_to_write;",
    "    789    ",
    "    790        return AP4_SUCCESS;"
  ]
}
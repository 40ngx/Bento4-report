{
  "Date": "2024-04-07T07:35:34.145081+00:00",
  "Uname": "Linux 9ef9146dd797 5.15.0-56-generic #62-Ubuntu SMP Tue Nov 22 19:54:14 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux",
  "OS": "Ubuntu",
  "OSRelease": "22.04",
  "Architecture": "amd64",
  "ExecutablePath": "../mp42ts",
  "ProcEnviron": [
    "PWD=/root/fuzzing_Bento4/Bento4/cmakebuild/fuzz",
    "HOME=/root",
    "TERM=xterm",
    "SHLVL=1",
    "PATH=/root/.cargo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
    "_=/usr/local/bin/casr-afl",
    "OLDPWD=/root/fuzzing_Bento4/Bento4/cmakebuild",
    "ASAN_OPTIONS=hard_rss_limit_mb=2048"
  ],
  "ProcCmdline": "../mp42ts out5/Secondary3/crashes/id:000289,sig:06,src:003056,time:58454739,execs:19026723,op:havoc,rep:1 mp42ts_out/out",
  "Stdin": "",
  "ProcStatus": [],
  "ProcMaps": [],
  "ProcFiles": [],
  "NetworkConnections": [],
  "CrashSeverity": {
    "Type": "NOT_EXPLOITABLE",
    "ShortDescription": "heap-buffer-overflow(read)",
    "Description": "Heap buffer overflow",
    "Explanation": "The target reads data past the end, or before the beginning, of the intended heap buffer."
  },
  "Stacktrace": [
    "    #0 0x5555557b7d52 in AP4_Mp4AudioDsiParser::ReadBits(unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Codecs/Ap4Mp4AudioInfo.cpp:66:56",
    "    #1 0x5555557bc79b in AP4_Mp4AudioDecoderConfig::ParseExtension(AP4_Mp4AudioDsiParser&) /root/fuzzing_Bento4/Bento4/Source/C++/Codecs/Ap4Mp4AudioInfo.cpp:159:20",
    "    #2 0x5555557bc79b in AP4_Mp4AudioDecoderConfig::Parse(unsigned char const*, unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Codecs/Ap4Mp4AudioInfo.cpp:317:30",
    "    #3 0x5555557b329d in AP4_Mpeg2TsAudioSampleStream::WriteSample(AP4_Sample&, AP4_DataBuffer&, AP4_SampleDescription*, bool, AP4_ByteStream&) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Mpeg2Ts.cpp:442:44",
    "    #4 0x5555556f40d4 in WriteSamples(AP4_Mpeg2TsWriter&, AP4_Track*, SampleReader*, AP4_Mpeg2TsWriter::SampleStream*, AP4_Track*, SampleReader*, AP4_Mpeg2TsWriter::SampleStream*, unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Apps/Mp42Ts/Mp42Ts.cpp:299:36",
    "    #5 0x5555556f40d4 in main /root/fuzzing_Bento4/Bento4/Source/C++/Apps/Mp42Ts/Mp42Ts.cpp:640:14",
    "    #6 0x7ffff7a7dd8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16",
    "    #7 0x7ffff7a7de3f in __libc_start_main csu/../csu/libc-start.c:392:3",
    "    #8 0x555555629a04 in _start (/root/fuzzing_Bento4/Bento4/cmakebuild/mp42ts+0xd5a04) (BuildId: e9d01274e1656fd8)"
  ],
  "Registers": {},
  "Disassembly": [],
  "Package": "",
  "PackageVersion": "",
  "PackageArchitecture": "",
  "PackageDescription": "",
  "AsanReport": [
    "==382733==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000178 at pc 0x5555557b7d53 bp 0x7fffffffd410 sp 0x7fffffffd408",
    "READ of size 1 at 0x602000000178 thread T0",
    "    #0 0x5555557b7d52 in AP4_Mp4AudioDsiParser::ReadBits(unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Codecs/Ap4Mp4AudioInfo.cpp:66:56",
    "    #1 0x5555557bc79b in AP4_Mp4AudioDecoderConfig::ParseExtension(AP4_Mp4AudioDsiParser&) /root/fuzzing_Bento4/Bento4/Source/C++/Codecs/Ap4Mp4AudioInfo.cpp:159:20",
    "    #2 0x5555557bc79b in AP4_Mp4AudioDecoderConfig::Parse(unsigned char const*, unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Codecs/Ap4Mp4AudioInfo.cpp:317:30",
    "    #3 0x5555557b329d in AP4_Mpeg2TsAudioSampleStream::WriteSample(AP4_Sample&, AP4_DataBuffer&, AP4_SampleDescription*, bool, AP4_ByteStream&) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Mpeg2Ts.cpp:442:44",
    "    #4 0x5555556f40d4 in WriteSamples(AP4_Mpeg2TsWriter&, AP4_Track*, SampleReader*, AP4_Mpeg2TsWriter::SampleStream*, AP4_Track*, SampleReader*, AP4_Mpeg2TsWriter::SampleStream*, unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Apps/Mp42Ts/Mp42Ts.cpp:299:36",
    "    #5 0x5555556f40d4 in main /root/fuzzing_Bento4/Bento4/Source/C++/Apps/Mp42Ts/Mp42Ts.cpp:640:14",
    "    #6 0x7ffff7a7dd8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16",
    "    #7 0x7ffff7a7de3f in __libc_start_main csu/../csu/libc-start.c:392:3",
    "    #8 0x555555629a04 in _start (/root/fuzzing_Bento4/Bento4/cmakebuild/mp42ts+0xd5a04) (BuildId: e9d01274e1656fd8)",
    "",
    "0x602000000178 is located 0 bytes to the right of 8-byte region [0x602000000170,0x602000000178)",
    "allocated by thread T0 here:",
    "    #0 0x5555556e77ad in operator new[](unsigned long) (/root/fuzzing_Bento4/Bento4/cmakebuild/mp42ts+0x1937ad) (BuildId: e9d01274e1656fd8)",
    "    #1 0x5555557038fb in AP4_DataBuffer::AP4_DataBuffer(void const*, unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4DataBuffer.cpp:68:20",
    "    #2 0x5555557b329d in AP4_Mpeg2TsAudioSampleStream::WriteSample(AP4_Sample&, AP4_DataBuffer&, AP4_SampleDescription*, bool, AP4_ByteStream&) /root/fuzzing_Bento4/Bento4/Source/C++/Core/Ap4Mpeg2Ts.cpp:442:44",
    "    #3 0x5555556f40d4 in WriteSamples(AP4_Mpeg2TsWriter&, AP4_Track*, SampleReader*, AP4_Mpeg2TsWriter::SampleStream*, AP4_Track*, SampleReader*, AP4_Mpeg2TsWriter::SampleStream*, unsigned int) /root/fuzzing_Bento4/Bento4/Source/C++/Apps/Mp42Ts/Mp42Ts.cpp:299:36",
    "    #4 0x5555556f40d4 in main /root/fuzzing_Bento4/Bento4/Source/C++/Apps/Mp42Ts/Mp42Ts.cpp:640:14",
    "    #5 0x7ffff7a7dd8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16",
    "",
    "SUMMARY: AddressSanitizer: heap-buffer-overflow /root/fuzzing_Bento4/Bento4/Source/C++/Codecs/Ap4Mp4AudioInfo.cpp:66:56 in AP4_Mp4AudioDsiParser::ReadBits(unsigned int)",
    "Shadow bytes around the buggy address:",
    "  0x0c047fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00",
    "  0x0c047fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00",
    "  0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00",
    "  0x0c047fff8000: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa fd fd",
    "  0x0c047fff8010: fa fa 04 fa fa fa 00 fa fa fa 00 fa fa fa 00 00",
    "=>0x0c047fff8020: fa fa 00 00 fa fa 00 fa fa fa 00 04 fa fa 00[fa]",
    "  0x0c047fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa",
    "  0x0c047fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa",
    "  0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa",
    "  0x0c047fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa",
    "  0x0c047fff8070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa",
    "Shadow byte legend (one shadow byte represents 8 application bytes):",
    "  Addressable:           00",
    "  Partially addressable: 01 02 03 04 05 06 07",
    "  Heap left redzone:       fa",
    "  Freed heap region:       fd",
    "  Stack left redzone:      f1",
    "  Stack mid redzone:       f2",
    "  Stack right redzone:     f3",
    "  Stack after return:      f5",
    "  Stack use after scope:   f8",
    "  Global redzone:          f9",
    "  Global init order:       f6",
    "  Poisoned by user:        f7",
    "  Container overflow:      fc",
    "  Array cookie:            ac",
    "  Intra object redzone:    bb",
    "  ASan internal:           fe",
    "  Left alloca redzone:     ca",
    "  Right alloca redzone:    cb",
    "==382733==ABORTING"
  ],
  "UbsanReport": [],
  "PythonReport": [],
  "GoReport": [],
  "JavaReport": [],
  "RustReport": [],
  "JsReport": [],
  "CSharpReport": [],
  "CrashLine": "/root/fuzzing_Bento4/Bento4/Source/C++/Codecs/Ap4Mp4AudioInfo.cpp:66:56",
  "Source": [
    "    62             const AP4_UI08* data = m_Data.GetData();",
    "    63             while (n) {",
    "    64                 unsigned int bits_avail = 8-(m_Position%8);",
    "    65                 unsigned int chunk_size = bits_avail >= n ? n : bits_avail;",
    "--->66                 unsigned int chunk_bits = (((unsigned int)(data[m_Position/8]))>>(bits_avail-chunk_size))&((1<<chunk_size)-1);",
    "    67                 result = (result << chunk_size) | chunk_bits;",
    "    68                 n -= chunk_size;",
    "    69                 m_Position += chunk_size;",
    "    70             }",
    "    71     "
  ]
}